version: 2

projects:

  - name: firewall_rules
    workflow: terraform
    dir: firewall_rules
    workspace: default
    terraform_version: v0.14.5
    autoplan:
      when_modified:
      - ".envrc"
      - "tfvars.json"
      enabled: true
    apply_requirements:
    - approved

workflows:
  terraform:
    plan:
      steps:
        - run: "source .envrc && make plan"
    apply:
      steps:
        - run: "source .envrc && make apply"